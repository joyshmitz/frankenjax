{
  "schema_version": "frankenjax.e2e.log.v1",
  "scenario_id": "e2e_p2c002_user_api_error_messages",
  "test_id": "e2e_p2c002::e2e_p2c002_user_api_error_messages",
  "packet_id": "P2C-002",
  "fixture_id": "36ccf0c0606c9fed7bd5a65a4807c44785c9bab0570a48084b875268e2791a62",
  "seed": null,
  "mode": "strict",
  "ts_utc_unix_ms": 1771580856950,
  "env": {
    "arch": "x86_64",
    "os": "linux",
    "rust_toolchain": "nightly-x86_64-unknown-linux-gnu"
  },
  "artifact_refs": [],
  "replay_command": "cargo test -p fj-conformance --test e2e_p2c002 -- e2e_p2c002_user_api_error_messages --exact --nocapture",
  "input_capture": {
    "description": "Invalid compositions produce user-friendly errors, not panics",
    "test_cases": [
      "grad with vector input",
      "grad with empty args",
      "vmap with scalar input",
      "grad(vmap(f)) invalid composition"
    ]
  },
  "intermediate_states": [
    {
      "error_message": "grad requires scalar input and output: grad currently requires scalar first input",
      "is_grad_requires_scalar": true,
      "message_is_user_friendly": true,
      "step": "grad_vector_error"
    },
    {
      "error_message": "evaluation error: grad requires at least one argument",
      "is_eval_error": true,
      "step": "grad_empty_args_error"
    },
    {
      "error_message": "evaluation error: vmap currently requires first argument with rank >= 1",
      "is_eval_error": true,
      "step": "vmap_scalar_error"
    },
    {
      "error_message": "grad requires scalar input and output: grad currently requires scalar first input",
      "is_grad_requires_scalar": true,
      "step": "grad_vmap_error"
    },
    {
      "step": "all_errors_user_friendly",
      "total_cases": 4
    }
  ],
  "output_capture": {
    "all_user_friendly": true,
    "cases_validated": 4,
    "grad_empty": {
      "message": "evaluation error: grad requires at least one argument",
      "type": "EvalError"
    },
    "grad_vector": {
      "message": "grad requires scalar input and output: grad currently requires scalar first input",
      "type": "GradRequiresScalar"
    },
    "grad_vmap": {
      "message": "grad requires scalar input and output: grad currently requires scalar first input",
      "type": "GradRequiresScalar"
    },
    "vmap_scalar": {
      "message": "evaluation error: vmap currently requires first argument with rank >= 1",
      "type": "EvalError"
    }
  },
  "result": "pass",
  "duration_ms": 0,
  "details": null
}